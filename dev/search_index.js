var documenterSearchIndex = {"docs":
[{"location":"tutorial/thresholdexceedance_ns/#Non-Stationary-Threshold-Exceedance-Model","page":"Non-stationary threshold exceedance","title":"Non-Stationary Threshold Exceedance Model","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"In the non-stationary threshold exceedance model, the GP parameters are allowed to be functions of multiple covariates:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"\\[ ϕ = X₂ × β₂ \\\\  ξ = X₃ × β₃ \\]","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"where (X₂β₂) and (X₃β₃) are respectively the design matrix and the corresponding coefficient parameter vector of ϕ and ξ.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"note: Intercept\nAn intercept is included in all parameter functions by default.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The non-stationary ThresholdExceedance model is illustrated using the daily rainfall accumulations at a location in south-west England from 1914 to 1962, studied by Coles (2001) in Chapter 6.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"using Extremes, DataFrames, Dates, Distributions, Gadfly, Statistics","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#Load-the-data","page":"Non-stationary threshold exceedance","title":"Load the data","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Loading the daily rainfall accumulations:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"data = Extremes.dataset(\"rain\")\nfirst(data,5)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Extract the exceedances over the threshold of 30 mm:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"threshold = 30.0\ndf = filter(row -> row.Rainfall > threshold, data)\ndf[!,:Exceedance] = df[:,:Rainfall] .- threshold\ndf[!,:Year] = year.(df[:,:Date])\nset_default_plot_size(12cm, 8cm) # hide\nplot(df, x=:Date, y=:Exceedance, Geom.point)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Non-stationary parameter estimation can be performed either by maximum likelihood or by the Bayesian approach. Probability weighted moment estimation cannot be used in the non-stationary case.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#Maximum-likelihood-inference","page":"Non-stationary threshold exceedance","title":"Maximum likelihood inference","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/#GP-parameter-estimation","page":"Non-stationary threshold exceedance","title":"GP parameter estimation","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The GP parameter estimation with maximum likelihood is performed with the gpfit function. The parameter estimate vector mathbfθ = (mathbfβ₂ mathbfβ₃)^top is contained in the field θ̂ of the returned structure.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Several non-stationary model can be fitted.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#The-stationary-model","page":"Non-stationary threshold exceedance","title":"The stationary model","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"fm₀ = gpfit(df, :Exceedance)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#The-logscale-parameter-varying-as-a-linear-function-of-the-year","page":"Non-stationary threshold exceedance","title":"The logscale parameter varying as a linear function of the year","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"fm₁ = gpfit(df, :Exceedance, logscalecovid = [:Year])","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Confidence intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"cint(fm₁)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"In particular, the 95% confidence interval for the rise in the log-scale parameter per year is as follows:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"cint(fm₁)[2]","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#Diagnostic-plots","page":"Non-stationary threshold exceedance","title":"Diagnostic plots","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Several diagnostic plots for assessing the accuracy of the GP model fitted to the rainfall data can be shown with the diagnosticplots function:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm₁)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The diagnostic plots consist in the residual probability plot (upper left panel), the residual quantile plot (upper right panel) and the residual density plot (lower left panel) of the standardized data (see Chapter 6 of Coles, 2001). These plots can be displayed separately using respectively the probplot, qqplot, histplot and returnlevelplot functions.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#Return-level-estimation","page":"Non-stationary threshold exceedance","title":"Return level estimation","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Since the model parameters vary in time, the quantiles also vary in time. Therefore, a T-year return level can be estimated for each year. This set of return levels are referred to as effective return levels as proposed by Katz et al. (2002)[1].","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The 100-year effective return levels for the fm₁ model can be computed using the returnlevel function:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"nobs = size(data,1)\nnobsperblock = 365\nr = returnlevel(fm₁, threshold, nobs, nobsperblock, 100)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The effective return levels can be accessed as follows:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"r.value","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The corresponding confidence interval can be computed with the cint function:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"c = cint(r)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The effective return levels along with their confidence intervals can be plotted as follows:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"rmin = [c[i][1] for i in eachindex(c)]\nrmax = [c[i][2] for i in eachindex(c)]\ndf_plot = DataFrame(Year = year.(df[:,:Date]), r = r.value, rmin = rmin, rmax = rmax)\nnothing # hide","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"set_default_plot_size(12cm, 8cm)\nplot(df_plot, x=:Year, y=:r, ymin=:rmin, ymax=rmax, Geom.line, Geom.ribbon,\n    Coord.cartesian(xmin=1910, xmax=1965), Guide.xticks(ticks=1910:5:1965),\n    Guide.ylabel(\"100-year Effective Return Level\"))","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#Bayesian-Inference","page":"Non-stationary threshold exceedance","title":"Bayesian Inference","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"Most functions described in the previous sections also work in the Bayesian context. To reproduce exactly the results, the seed should be fixed as follows:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"import Random\nRandom.seed!(4786)\nnothing #hide","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#GP-parameter-estimation-2","page":"Non-stationary threshold exceedance","title":"GP parameter estimation","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The Bayesian GP parameter estimation is performed with the gpfitbayes function:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"\nfm = gpfitbayes(df, :Exceedance, logscalecovid = [:Year])","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"note: Prior\nCurrently, only the improper uniform prior is implemented, i.e. \\[ f_{(β₂,β₃)}(β₂,β₃) ∝ 1. \\]","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"[1]: Katz, R. W., M. B. Parlange, and P. Naveau (2002), Statistics of extremes in hydrology, Adv. Water Resour., 25, 1287–1304.","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The model fit can be assessed with the diagnostic plots using the function diagnosticplots:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The empirical covariance matrix of the parameters and the credible intervals can be obtained with the functions parametervar and cint, respectively:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"parametervar(fm)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"cint(fm, .95)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/#Return-level-estimation-2","page":"Non-stationary threshold exceedance","title":"Return level estimation","text":"","category":"section"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The 100-year effective return level estimates can be obtained using the function returnlevel:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"nobs = size(data,1)\nnobsperblock = 365\nr = returnlevel(fm, threshold, nobs, nobsperblock, 100)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The corresponding 95% credible interval can be computed using the function cint:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"c = cint(r, 0.95)","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"The 100-year effective return levels along with their 95% credible intervals can be illustrated as follows:","category":"page"},{"location":"tutorial/thresholdexceedance_ns/","page":"Non-stationary threshold exceedance","title":"Non-stationary threshold exceedance","text":"df_plot = DataFrame(Year=df.Year, ReturnLevel = vec(mean(r.value, dims=1)), \n    LowerBound = first.(c), UpperBound=last.(c))\n\nset_default_plot_size(12cm, 8cm)\nplot(df_plot, x=:Year, y=:ReturnLevel, Geom.line,\n    ymin=:LowerBound, ymax=:UpperBound, Geom.ribbon,\n    Guide.ylabel(\"100-year effective return level\"))","category":"page"},{"location":"functions/#Functions","page":"Functions","title":"Functions","text":"","category":"section"},{"location":"functions/#Parameter-estimation","page":"Functions","title":"Parameter estimation","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"Modules = [Extremes]\nPrivate = false\nOrder = [:function]\nPages = [\n    \"src/parameterestimation/maximumlikelihood.jl\",\n    \"src/parameterestimation/probabilityweightedmoment.jl\",\n    \"src/parameterestimation/bayesian.jl\",\n    \"src/parameterestimation/maximumlikelihood/maximumlikelihood_gev.jl\",\n    \"src/parameterestimation/maximumlikelihood/maximumlikelihood_gumbel.jl\",\n    \"src/parameterestimation/maximumlikelihood/maximumlikelihood_gp.jl\",\n    \"src/parameterestimation/probabilityweightedmoment/probabilityweightedmoment_gev.jl\",\n    \"src/parameterestimation/probabilityweightedmoment/probabilityweightedmoment_gumbel.jl\",\n    \"src/parameterestimation/probabilityweightedmoment/probabilityweightedmoment_gp.jl\",\n    \"src/parameterestimation/bayesian/bayesian_gev.jl\",\n    \"src/parameterestimation/bayesian/bayesian_gumbel.jl\",\n    \"src/parameterestimation/bayesian/bayesian_gp.jl\"\n    ]","category":"page"},{"location":"functions/#Extremes.gevfit","page":"Functions","title":"Extremes.gevfit","text":"gevfit()\n\nEstimate the GEV parameters by maximum likelihood.\n\nImplementation\n\nThe function uses Nelder-Mead solver implemented in the Optim.jl package to find the point where the log-likelihood is maximal.\n\nThe GEV parameters can be modeled as function of covariates as follows:\n\nμ = X₁  β₁\n\nϕ = X₂  β₂\n\nξ = X₃  β₃\n\nThe covariates are standardized before estimating the parameters to help fit the  model. They are transformed back on their original scales before returning the  fitted model.\n\nSee also gevfit for the other methods, gevfitpwm, gevfitbayes and BlockMaxima.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gevfit-Tuple{BlockMaxima{Distributions.GeneralizedExtremeValue}, Vector{<:Real}}","page":"Functions","title":"Extremes.gevfit","text":"gevfit(model::{BlockMaxima{GeneralizedExtremeValue}}, initialvalues::Vector{<:Real})\n\nEstimate the parameters of the BlockMaxima model using the given initialvalues.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfit-Tuple{DataFrames.DataFrame, Symbol, Vector{<:Real}}","page":"Functions","title":"Extremes.gevfit","text":"gevfit(df::DataFrame,\n    datacol::Symbol,\n    locationcovid = Vector{Symbol}(),\n    logscalecovid = Vector{Symbol}(),\n    shapecovid = Vector{Symbol}()\n    )\n\nEstimate the GEV parameters.\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the block maxima data.\ninitialvalues::Vector{<:Real}: Vector of parameters initial values.\nlocationcovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the location parameter.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\nshapecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfit-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gevfit","text":"gevfit(df::DataFrame,\n    datacol::Symbol,\n    locationcovid = Vector{Symbol}(),\n    logscalecovid = Vector{Symbol}(),\n    shapecovid = Vector{Symbol}()\n    )\n\nEstimate the GEV parameters.\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the block maxima data.\nlocationcovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the location parameter.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\nshapecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfit-Tuple{Vector{<:Real}, Vector{<:Real}}","page":"Functions","title":"Extremes.gevfit","text":"gevfit(y,\n    initialvalues,\n    locationcov = Vector{Variable}(),\n    logscalecov = Vector{Variable}(),\n    shapecov = Vector{Variable}()\n    )\n\nEstimate the GEV parameters.\n\nArguments\n\ny::Vector{<:Real}: the vector of block maxima.\ninitialvalues::Vector{<:Real}: Vector of parameters initial values.\nlocationcov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the location parameter.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\nshapecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfit-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gevfit","text":"gevfit(y,\n    locationcov = Vector{Variable}(),\n    logscalecov = Vector{Variable}(),\n    shapecov = Vector{Variable}()\n    )\n\nEstimate the GEV parameters.\n\nArguments\n\ny::Vector{<:Real}: The vector of block maxima.\nlocationcov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the location parameter.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\nshapecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfit","page":"Functions","title":"Extremes.gumbelfit","text":"gumbelfit()\n\nEstimate the Gumbel parameters by maximum likelihood.\n\nDetails\n\nThe Gumbel distribution is a particular case of the generalized extreme value distribution when the shape parameter is zero.\n\nnote: Extreme value theory\nIn extreme value theory, it is best to avoid the choice of a sub-family of extreme value familu as the Gumbel. This is because the choice of family is made with the data at hand,  and when extrapolating to large quantiles, i.e. larger than the range of the data, the uncertainty associated with this choice is not taken into account. If the data suggest that  the Gumbel family is the best one, this does not imply that the other families are not plausible. In applications, the confidence intervals on the shape parameter are often wide,  representing the difficulty of discriminating the tail behavior using only the limited number of data. Therefore, the use of the GEV distribution for the block maxima model makes  more sense. As Coles (2001) also argued in Page 64, this is  \"...the safest option is to accept there is uncertainty about the value of the shape parameter ... and to prefer the  inference based on the GEV model. The larger measures of uncertainty generated by the GEV model then provide a more realistic quantification of the genuine uncertainties involved   in model extrapolation.\" \n\nImplementation\n\nThe function uses Nelder-Mead solver implemented in the Optim.jl package to find the point where the log-likelihood is maximal.\n\nThe Gumbel parameters can be modeled as function of covariates as follows:\n\nμ = X₁  β₁\n\nϕ = X₂  β₂\n\nThe covariates are standardized before estimating the parameters to help fit the  model. They are transformed back on their original scales before returning the  fitted model.\n\nSee also gumbelfit for the other methods and gevfit for estiming the parameters of the GEV distribution.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gumbelfit-Tuple{BlockMaxima{Distributions.Gumbel}, Vector{<:Real}}","page":"Functions","title":"Extremes.gumbelfit","text":"gumbelfit(model::{BlockMaxima{Gumbel}}, initialvalues::Vector{<:Real})\n\nEstimate the parameters of the BlockMaxima model using the given initialvalues.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfit-Tuple{DataFrames.DataFrame, Symbol, Vector{<:Real}}","page":"Functions","title":"Extremes.gumbelfit","text":"gumbelfit(df::DataFrame,\n    datacol::Symbol,\n    locationcovid = Vector{Symbol}(),\n    logscalecovid = Vector{Symbol}()\n    )\n\nEstimate the Gumbel parameters.\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the block maxima data.\ninitialvalues::Vector{<:Real}: Vector of parameters initial values.\nlocationcovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the location parameter.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfit-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gumbelfit","text":"gumbelfit(df::DataFrame,\n    datacol::Symbol,\n    locationcovid = Vector{Symbol}(),\n    logscalecovid = Vector{Symbol}(),\n    shapecovid = Vector{Symbol}()\n    )\n\nEstimate the Gumbel parameters.\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the block maxima data.\nlocationcovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the location parameter.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfit-Tuple{Vector{<:Real}, Vector{<:Real}}","page":"Functions","title":"Extremes.gumbelfit","text":"gumbelfit(y,\n    initialvalues,\n    locationcov = Vector{Variable}(),\n    logscalecov = Vector{Variable}()\n    )\n\nEstimate the Gumbel parameters.\n\nArguments\n\ny::Vector{<:Real}: the vector of block maxima.\ninitialvalues::Vector{<:Real}: Vector of parameters initial values.\nlocationcov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the location parameter.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfit-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gumbelfit","text":"gumbelfit(y,\n    locationcov = Vector{Variable}(),\n    logscalecov = Vector{Variable}()\n    )\n\nEstimate the Gumbel parameters.\n\nArguments\n\ny::Vector{<:Real}: The vector of block maxima.\nlocationcov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the location parameter.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfit","page":"Functions","title":"Extremes.gpfit","text":"gpfit(...)\n\nEstimate the GP parameters by maximum likelihood.\n\nData provided must be the exceedances above the threshold, i.e. the data above the threshold minus the threshold.\n\nImplementation\n\nThe function uses Nelder-Mead solver implemented in the Optim.jl package to find the point where the log-likelihood is maximal.\n\nThe GP parameters can be modeled as function of covariates as follows:\n\nϕ = X₂  β₂\n\nξ = X₃  β₃\n\nThe covariates are standardized before estimating the parameters to help fit the  model. They are transformed back on their original scales before returning the  fitted model.\n\nSee also gpfit for the other methods, gpfitpwm, gpfitbayes and ThresholdExceedance.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gpfit-Tuple{DataFrames.DataFrame, Symbol, Vector{<:Real}}","page":"Functions","title":"Extremes.gpfit","text":"gpfit(df::DataFrame,\n    datacol::Symbol,\n    logscalecovid = Vector{Symbol}(),\n    shapecovid = Vector{Symbol}()\n    )\n\nEstimate the GP parameters\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the exceedances.\ninitialvalues::Vector{<:Real}: Vector of parameters initial values.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\nshapecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfit-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gpfit","text":"gpfit(df::DataFrame,\n    datacol::Symbol,\n    logscalecovid = Vector{Symbol}(),\n    shapecovid = Vector{Symbol}()\n    )\n\nEstimate the GP parameters\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the exceedances.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\nshapecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfit-Tuple{ThresholdExceedance, Vector{<:Real}}","page":"Functions","title":"Extremes.gpfit","text":"gpfit(model::ThresholdExceedance, initialvalues::Vector{<:Real})\n\nEstimate the parameters of the ThresholdExceedance model using the given initialvalues.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfit-Tuple{Vector{<:Real}, Vector{<:Real}}","page":"Functions","title":"Extremes.gpfit","text":"gpfit(y,\n    initialvalues;\n    logscalecov = Vector{Variable}(),\n    shapecov = Vector{Variable}()\n    )\n\nEstimate the GP parameters\n\nArguments\n\ny::Vector{<:Real}: The vector of exceedances.\ninitialvalues::Vector{<:Real}: The vector of parameters initial values.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\nshapecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfit-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gpfit","text":"gpfit(y,\n    logscalecov = Vector{Variable}(),\n    shapecov = Vector{Variable}()\n    )\n\nEstimate the GP parameters\n\nArguments\n\ny::Vector{<:Real}: The vector of exceedances.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\nshapecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfitpwm","page":"Functions","title":"Extremes.gevfitpwm","text":"gevfitpwm(...)\n\nEstimate the GEV parameters with the probability weighted moments.\n\nImplementation\n\nEstimation with the probability weighted moments, as described by Hosking et al. (1985), is only possible in the stationary case.\n\nSee also gevfitpwm for the other methods, gevfit, gevfitbayes and BlockMaxima.\n\nReference\n\nHosking, J. R. M., Wallis, J. R. and Wood, E. F. (1985). Estimation of the generalized extreme-value     distribution by the method of probability-weighted moments. Technometrics, 27:251-261.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gevfitpwm-Tuple{BlockMaxima{Distributions.GeneralizedExtremeValue}}","page":"Functions","title":"Extremes.gevfitpwm","text":"gevfitpwm(model::BlockMaxima{GeneralizedExtremeValue})\n\nEstimate the GEV parameters with the probability weighted moments.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfitpwm-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gevfitpwm","text":"gevfitpwm(df::DataFrame, datacol::Symbol)\n\nEstimate the GEV parameters with the probability weighted moments.\n\nBlock maxima data are in the column datacol of the dataframe df.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfitpwm-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gevfitpwm","text":"gevfitpwm(y::Vector{<:Real})\n\nEstimate the GEV parameters with the probability weighted moments.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfitpwm","page":"Functions","title":"Extremes.gumbelfitpwm","text":"gumbelfitpwm(...)\n\nEstimate the Gumbel parameters with the probability weighted moments.\n\nImplementation\n\nEstimation with the probability weighted moments, as described by Landwehr *et al. (1979), is only possible in the stationary case.\n\nSee also gumbelfitpwm for the other methods, gevfit, gevfitbayes and BlockMaxima.\n\nReference\n\nLandwehr, J. M., Matalas, N. C. and Wallis, J. R. (1979). Probability weighted moments compared with     some traditional techniques in estimating Gumbel parameters and quantiles. Water Resources Research,     15:1055–1064.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gumbelfitpwm-Tuple{BlockMaxima{Distributions.Gumbel}}","page":"Functions","title":"Extremes.gumbelfitpwm","text":"gumbelfitpwm(model::BlockMaxima{Gumbel})\n\nEstimate the Gumbel parameters with the probability weighted moments.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfitpwm-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gumbelfitpwm","text":"gumbelfitpwm(df::DataFrame, datacol::Symbol)::pwmAbstractExtremeValueModel\n\nEstimate the Gumbel parameters with the probability weighted moments.\n\nBlock maxima data are in the column datacol of the dataframe df.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfitpwm-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gumbelfitpwm","text":"gumbelfitpwm(y::Vector{<:Real})\n\nEstimate the Gumbel parameters with the probability weighted moments.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfitpwm","page":"Functions","title":"Extremes.gpfitpwm","text":"gpfitpwm(...)\n\nEstimate the GP parameters with the probability weighted moments.\n\nImplementation\n\nEstimation with the probability weighted moments, as described by Hosking and Wallis (1987), is only possible in the stationary case.\n\nSee also gpfitpwm for the other methods, gpfit, gpfitbayes and ThresholdExceedance.\n\nReference\n\nHosking, J. R. M. and Wallis, J. R. (1987). Parameter and quantile estimation for the Generalized Pareto distribution,     Technometrics, 29:339-349.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gpfitpwm-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gpfitpwm","text":"gpfitpwm(df::DataFrame, datacol::Symbol)\n\nEstimate the GP parameters with the probability weighted moments.\n\nBlock maxima data are in the column datacol of the dataframe df.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfitpwm-Tuple{ThresholdExceedance}","page":"Functions","title":"Extremes.gpfitpwm","text":"gpfitpwm(model::ThresholdExceedance)\n\nEstimate the GP parameters with the probability weighted moments.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfitpwm-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gpfitpwm","text":"gpfitpwm(y::Vector{<:Real})\n\nEstimate the GP parameters with the probability weighted moments.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfitbayes","page":"Functions","title":"Extremes.gevfitbayes","text":"gevfitbayes(..., niter::Int=5000, warmup::Int=2000)\n\nGenerate a sample from the GEV parameters' posterior distribution.\n\nArguments\n\nniter::Int = 5000: The total number of MCMC iterations.\nwarmup::Int = 2000: The number of warmup iterations (burn-in).\n\nImplementation\n\nThe function uses the No-U-Turn Sampler (NUTS; Hoffman and Gelman, 2014) implemented in the Mamba.jl package to generate a random sample from the posterior distribution.\n\nCurrently, only the improper uniform prior is implemented, i.e.\n\nf_(β₁β₂β₃)(β₁β₂β₃)  1\n\nwhere\n\nμ = X₁  β₁\n\nϕ = X₂  β₂\n\nξ = X₃  β₃\n\nIn the stationary case, this improper prior yields to a proper posterior if the sample size is larger than 3 (Northrop and Attalides, 2016).\n\nThe covariates are standardized before estimating the parameters to help fit the  model. They are transformed back on their original scales before returning the  fitted model.\n\nSee also gevfitbayes for the other methods, gevfitpwm, gevfit and BlockMaxima.\n\nReferences\n\nHoffman M. D. and Gelman A. (2014). The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo. Journal of Machine Learning Research, 15:1593–1623.\n\nPaul J. Northrop P. J. and Attalides N. (2016). Posterior propriety in Bayesian extreme value analyses using reference priors. Statistica Sinica, 26:721-743.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gevfitbayes-Tuple{BlockMaxima{Distributions.GeneralizedExtremeValue}}","page":"Functions","title":"Extremes.gevfitbayes","text":"gevfitbayes(model::BlockMaxima{GeneralizedExtremeValue};\n    niter::Int=5000,\n    warmup::Int=2000)\n\nGenerate a sample from the BlockMaxima model parameters' posterior distribution.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfitbayes-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gevfitbayes","text":"gevfitbayes(df::DataFrame,\n    datacol::Symbol,\n    locationcovid = Vector{Symbol}(),\n    logscalecovid = Vector{Symbol}(),\n    shapecovid = Vector{Symbol}(),\n    niter::Int=5000,\n    warmup::Int=2000)\n\nGenerate a sample from the GEV parameters' posterior distribution.\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the block maxima data.\nlocationcovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the location parameter.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\nshapecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gevfitbayes-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gevfitbayes","text":"gevfitbayes(y,\n    locationcov = Vector{Variable}(),\n    logscalecov = Vector{Variable}(),\n    shapecov = Vector{Variable}(),\n    niter::Int=5000,\n    warmup::Int=2000\n    )\n\nGenerate a sample from the GEV parameters' posterior distribution.\n\nArguments\n\ny::Vector{<:Real}: The vector of block maxima.\nlocationcov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the location parameter.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\nshapecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfitbayes","page":"Functions","title":"Extremes.gumbelfitbayes","text":"gumbelfitbayes(..., niter::Int=5000, warmup::Int=2000)\n\nGenerate a sample from the Gumbel parameters' posterior distribution.\n\nArguments\n\nniter::Int = 5000: The total number of MCMC iterations.\nwarmup::Int = 2000: The number of warmup iterations (burn-in).\n\nImplementation\n\nThe function uses the No-U-Turn Sampler (NUTS; Hoffman and Gelman, 2014) implemented in the Mamba.jl package to generate a random sample from the posterior distribution.\n\nCurrently, only the improper uniform prior is implemented, i.e.\n\nf_(β₁β₂β₃)(β₁β₂β₃)  1\n\nwhere\n\nμ = X₁  β₁\n\nϕ = X₂  β₂\n\nIn the stationary case, this improper prior yields to a proper posterior if the sample size is larger than 3 (Northrop and Attalides, 2016).\n\nThe covariates are standardized before estimating the parameters to help fit the  model. They are transformed back on their original scales before returning the  fitted model.\n\nSee also gevfitbayes for the other methods and BlockMaxima.\n\nReferences\n\nHoffman M. D. and Gelman A. (2014). The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo. Journal of Machine Learning Research, 15:1593–1623.\n\nPaul J. Northrop P. J. and Attalides N. (2016). Posterior propriety in Bayesian extreme value analyses using reference priors. Statistica Sinica, 26:721-743.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gumbelfitbayes-Tuple{BlockMaxima{Distributions.Gumbel}}","page":"Functions","title":"Extremes.gumbelfitbayes","text":"gumbelfitbayes(model::BlockMaxima{Gumbel};\n    niter::Int=5000,\n    warmup::Int=2000)\n\nGenerate a sample from the BlockMaxima model parameters' posterior distribution.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfitbayes-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gumbelfitbayes","text":"gumbelfitbayes(df::DataFrame,\n    datacol::Symbol,\n    locationcovid = Vector{Symbol}(),\n    logscalecovid = Vector{Symbol}(),\n    niter::Int=5000,\n    warmup::Int=2000)\n\nGenerate a sample from the Gumbel parameters' posterior distribution.\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the block maxima data.\nlocationcovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the location parameter.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gumbelfitbayes-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gumbelfitbayes","text":"gumbelfitbayes(y,\n    locationcov = Vector{Variable}(),\n    logscalecov = Vector{Variable}(),\n    niter::Int=5000,\n    warmup::Int=2000\n    )\n\nGenerate a sample from the Gumbel parameters' posterior distribution.\n\nArguments\n\ny::Vector{<:Real}: The vector of block maxima.\nlocationcov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the location parameter.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfitbayes","page":"Functions","title":"Extremes.gpfitbayes","text":"gpfitbayes(..., niter::Int=5000, warmup::Int=2000)\n\nGenerate a sample from the GP parameters' posterior distribution.\n\nData provided must be the exceedances above the threshold, i.e. the data above the threshold minus the threshold.\n\nArguments\n\nniter::Int = 5000: The total number of MCMC iterations\nwarmup::Int = 2000: The number of warmup iterations (burn-in).\n\nImplementation\n\nThe function uses the No-U-Turn Sampler (NUTS; Hoffman and Gelman, 2014) implemented in the Mamba.jl package to generate a random sample from the posterior distribution.\n\nCurrently, only the improper uniform prior is implemented, i.e.\n\nf_(β₂β₃)(β₂β₃)  1\n\nwhere\n\nϕ = X₂  β₂\n\nξ = X₃  β₃\n\nIn the stationary case, this improper prior yields to a proper posterior if the sample size is larger than 2 (Northrop and Attalides, 2016).\n\nThe covariates are standardized before estimating the parameters to help fit the  model. They are transformed back on their original scales before returning the  fitted model.\n\nSee also gpfitbayes for the other methods, gpfitpwm, gpfit and ThresholdExceedance.\n\nReference\n\nHoffman M. D. and Gelman A. (2014). The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo. Journal of Machine Learning Research, 15:1593–1623.\n\nPaul J. Northrop P. J. and Attalides N. (2016). Posterior propriety in Bayesian extreme value analyses using reference priors. Statistica Sinica, 26:721-743.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.gpfitbayes-Tuple{DataFrames.DataFrame, Symbol}","page":"Functions","title":"Extremes.gpfitbayes","text":"gpfitbayes(df::DataFrame,\n    datacol::Symbol,\n    logscalecovid = Vector{Symbol}(),\n    shapecovid = Vector{Symbol}(),\n    niter::Int=5000,\n    warmup::Int=2000)\n\nGenerate a sample from the GP parameters' posterior distribution.\n\nArguments\n\ndf::DataFrame: The dataframe containing the data.\ndatacol::Symbol: The symbol of the column of df containing the exceedances.\nlogscalecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the log-scale parameter.\nshapecovid::Vector{Symbol} = Vector{Symbol}(): The symbols of the columns of df containing the covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfitbayes-Tuple{ThresholdExceedance}","page":"Functions","title":"Extremes.gpfitbayes","text":"gpfitbayes(model::ThresholdExceedance;\n    niter::Int=5000,\n    warmup::Int=2000)\n\nGenerate a sample from the GP parameters' posterior distribution.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.gpfitbayes-Tuple{Vector{<:Real}}","page":"Functions","title":"Extremes.gpfitbayes","text":"gpfitbayes(y,\n    logscalecov = Vector{Variable}(),\n    shapecov = Vector{Variable}(),\n    niter::Int=5000,\n    warmup::Int=2000\n    )\n\nGenerate a sample from the GP parameters' posterior distribution.\n\nArguments\n\ny::Vector{<:Real}: The vector of exceedances.\nlogscalecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the log-scale parameter.\nshapecov::Vector{<:DataItem} = Vector{Variable}(): The covariates of the shape parameter.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Methods-on-fitted-models","page":"Functions","title":"Methods on fitted models","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"Modules = [Extremes]\nPrivate = false\nOrder = [:function]\nPages = [\n    \"src/structures/cluster.jl\",\n    \"src/structures/dataitem.jl\",\n    \"src/structures/AbstractExtremeValueModel.jl\",\n    \"src/structures/AbstractFittedExtremeValueModel.jl\",\n    \"src/structures/returnlevel.jl\",\n    \"src/structures/dataitem/variable.jl\",\n    \"src/structures/dataitem/variablestd.jl\",\n    \"src/structures/AbstractExtremeValueModel/blockmaxima.jl\",\n    \"src/structures/AbstractExtremeValueModel/thresholdexceedance.jl\",\n    \"src/structures/AbstractFittedExtremeValueModel/bayesianAbstractExtremeValueModel.jl\",\n    \"src/structures/AbstractFittedExtremeValueModel/maximumlikelihoodAbstractExtremeValueModel.jl\",\n    \"src/structures/AbstractFittedExtremeValueModel/pwmAbstractExtremeValueModel.jl\"\n    ]","category":"page"},{"location":"functions/#Extremes.getcluster-Tuple{Vector{<:Real}, Real, Real}","page":"Functions","title":"Extremes.getcluster","text":"getcluster(y::Vector{<:Real}, u₁::Real, u₂::Real)\n\nExtract the clusters from vector y.\n\nA cluster is defined as a sequence of values higher than threshold u₂ with at least a value higher than threshold u₁.\n\nSee also Cluster.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.getcluster-Tuple{Vector{<:Real}, Real}","page":"Functions","title":"Extremes.getcluster","text":"getcluster(y::Vector{<:Real}, u::Real; runlength::Int=1)::Vector{Cluster}\n\nExtract the clusters from vector y.\n\nThreshold exceedances separated by fewer than r non-exceedances belong to the same cluster. The value r is corresponds to the runlength parameter. This approach is referred to as the runs declustering scheme (see Coles, 2001 sec. 5.3.2).\n\nSee also Cluster.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Distributions.location-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Distributions.location","text":"location(fm::AbstractFittedExtremeValueModel)\n\nReturn the location parameters of the fitted model.     \n\n\n\n\n\n","category":"method"},{"location":"functions/#Distributions.scale-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Distributions.scale","text":"scale(fm::AbstractFittedExtremeValueModel)\n\nReturn the scale parameters of the fitted model.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Distributions.shape-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Distributions.shape","text":"shape(fm::AbstractFittedExtremeValueModel)\n\nReturn the shape parameters of the fitted model.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.cint","page":"Functions","title":"Extremes.cint","text":"cint(..., confidencelevel::Real=.95)\n\nCompute confidence interval or credible interval in the case of Bayesian estimation.\n\nThe function can be applied on any AbstractFittedExtremeValueModel subtype to obtain a confidence interval on the model parameters. It can also be applied on ReturnLevel type to obtain a confidence interval on the return level.\n\nImplementation\n\nThe method used for computing the interval depends on the estimation method. In the case of maximum likelihood estimation, the confidence intervals are computed using the Wald approximation based on the approximate parameter estimates covariance matrix. In the case of Bayesian estimation, the return interval is the highest posterior density estimate based on the MCMC sample. In the case of probability weighted moment estimation, the intervals are computed using a boostrap procedure.\n\n\n\n\n\n","category":"function"},{"location":"functions/#StatsAPI.params-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"StatsAPI.params","text":"params(fm::AbstractFittedExtremeValueModel)\n\nReturn the parameters of the fitted model.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.parametervar-Tuple{BayesianAbstractExtremeValueModel}","page":"Functions","title":"Extremes.parametervar","text":"parametervar(fm::BayesianAbstractExtremeValueModel)::Array{Float64, 2}\n\nCompute the covariance parameters estimate of the fitted model fm.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.returnlevel-Tuple{BayesianAbstractExtremeValueModel{ThresholdExceedance}, Real, Int64, Int64, Real}","page":"Functions","title":"Extremes.returnlevel","text":"returnlevel(fm::BayesianAbstractExtremeValueModel{ThresholdExceedance}, threshold::Real, nobservation::Int,\n    nobsperblock::Int, returnPeriod::Real)::ReturnLevel\n\nCompute the return level corresponding to the return period returnPeriod from the fitted model fm.\n\nThe threshold should be a scalar. A varying threshold is not yet implemented.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.returnlevel-Union{Tuple{T}, Tuple{BayesianAbstractExtremeValueModel{BlockMaxima{T}}, Real}} where T","page":"Functions","title":"Extremes.returnlevel","text":"returnlevel(fm::BayesianAbstractExtremeValueModel{BlockMaxima}, returnPeriod::Real)::ReturnLevel\n\nCompute the return level corresponding to the return period returnPeriod from the fitted model fm.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.aic-Tuple{MaximumLikelihoodAbstractExtremeValueModel}","page":"Functions","title":"Extremes.aic","text":"aic(fm:::MaximumLikelihoodAbstractExtremeValueModel)\n\nCompute the Akaike information criterion (AIC) of the fitted model by maximum likelihood method.\n\nDetails\n\nThe AIC is defined as follows:\n\nAIC = 2 k - 2 log hatL\n\nwhere k is the number of estimated parameters and hatL is the maximized value of the likelihood function for the model. \n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.bic-Tuple{MaximumLikelihoodAbstractExtremeValueModel}","page":"Functions","title":"Extremes.bic","text":"bic(fm:::MaximumLikelihoodAbstractExtremeValueModel)\n\nCompute the Bayesian information criterion (BIC) of the fitted model by maximum likelihood method.\n\nDetails\n\nThe BIC is defined as follows:\n\nBIC = k log n - 2 log hatL\n\nwhere k is the number of estimated parameters, n is the number of data and hatL is the maximized value of the likelihood function for the model. \n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.parametervar-Tuple{MaximumLikelihoodAbstractExtremeValueModel}","page":"Functions","title":"Extremes.parametervar","text":"parametervar(fm::MaximumLikelihoodAbstractExtremeValueModel)::Array{Float64, 2}\n\nCompute the covariance parameters estimate of the fitted model fm.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.returnlevel-Tuple{MaximumLikelihoodAbstractExtremeValueModel{ThresholdExceedance}, Real, Int64, Int64, Real}","page":"Functions","title":"Extremes.returnlevel","text":"returnlevel(fm::MaximumLikelihoodAbstractExtremeValueModel{ThresholdExceedance}, threshold::Real, nobservation::Int,\n    nobsperblock::Int, returnPeriod::Real)::ReturnLevel\n\nCompute the return level corresponding to the return period returnPeriod from the fitted model fm.\n\nThe threshold should be a scalar. A varying threshold is not yet implemented.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.returnlevel-Union{Tuple{T}, Tuple{MaximumLikelihoodAbstractExtremeValueModel{BlockMaxima{T}}, Real}} where T","page":"Functions","title":"Extremes.returnlevel","text":"returnlevel(fm::MaximumLikelihoodAbstractExtremeValueModel{BlockMaxima}, returnPeriod::Real)::ReturnLevel\n\nCompute the return level corresponding to the return period returnPeriod from the fitted model fm.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.parametervar","page":"Functions","title":"Extremes.parametervar","text":"parametervar(fm::pwmAbstractExtremeValueModel, nboot::Int=1000)\n\nEstimate the parameter estimates covariance matrix by bootstrap.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.returnlevel-Tuple{pwmAbstractExtremeValueModel{ThresholdExceedance}, Real, Int64, Int64, Real}","page":"Functions","title":"Extremes.returnlevel","text":"returnlevel(fm::pwmAbstractExtremeValueModel{ThresholdExceedance, T} where T<:Distribution, threshold::Real, nobservation::Int,\n    nobsperblock::Int, returnPeriod::Real)::ReturnLevel\n\nCompute the return level corresponding to the return period returnPeriod from the fitted model fm.\n\nThe threshold should be a scalar. A varying threshold is not yet implemented.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.returnlevel-Union{Tuple{T}, Tuple{pwmAbstractExtremeValueModel{BlockMaxima{T}}, Real}} where T","page":"Functions","title":"Extremes.returnlevel","text":"returnlevel(fm::pwmAbstractExtremeValueModel{BlockMaxima, T} where T<:Distribution, returnPeriod::Real)::ReturnLevel\n\nCompute the confidence intervel for the return level corresponding to the return period returnPeriod from the fitted model fm with confidence level confidencelevel.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Diagnostic-plots","page":"Functions","title":"Diagnostic plots","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"Modules = [Extremes]\nPrivate = false\nOrder = [:function]\nPages = [\n    \"src/validationplots/plots.jl\",\n    \"src/validationplots/plots_data.jl\",\n    \"src/validationplots/plots_std_data.jl\"\n    ]","category":"page"},{"location":"functions/#Extremes.diagnosticplots-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Extremes.diagnosticplots","text":"diagnosticplots(fm::AbstractFittedExtremeValueModel)\n\nDiagnostic plots\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.histplot-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Extremes.histplot","text":"histplot(fm::AbstractFittedExtremeValueModel)\n\nHistogram plot\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.mrlplot","page":"Functions","title":"Extremes.mrlplot","text":"mrlplot(y::Vector{<:Real}, steps::Int = 100)\n\nMean residual plot\n\nSee also mrlplot_data.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.probplot-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Extremes.probplot","text":"probplot(fm::AbstractFittedExtremeValueModel)\n\nProbability plot\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.qqplot-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Extremes.qqplot","text":"qqplot(fm::AbstractFittedExtremeValueModel)\n\nQuantile-Quantile plot\n\nSee also qqplotci.   \n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.qqplotci","page":"Functions","title":"Extremes.qqplotci","text":"qqplotci(fm::AbstractFittedExtremeValueModel, α::Real=.05)\n\nQuantile-Quantile plot along with the confidence/credible interval of level 1-α.\n\nNote\n\nThis function is currently only available for stationary models.\n\nSee also returnlevelplotci and qqplot.   \n\nExample\n\nusing Distributions, Extremes\n\npd = GeneralizedExtremeValue(0,1,0)\ny = rand(pd, 300)\nfm = gevfit(y)\n\nqqplotci(fm)\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.returnlevelplot-Tuple{AbstractFittedExtremeValueModel}","page":"Functions","title":"Extremes.returnlevelplot","text":"returnlevelplot(fm::AbstractFittedExtremeValueModel)\n\nReturn level plot\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.returnlevelplotci","page":"Functions","title":"Extremes.returnlevelplotci","text":"returnlevelplotci(fm::AbstractFittedExtremeValueModel, α::Real=.05)\n\nReturn level plot along with the confidence/credible interval of level 1-α.\n\nNote\n\nThis function is currently only available for stationary models.\n\nSee also returnlevelplotci and qqplot.   \n\nExample\n\nusing Distributions, Extremes\n\npd = GeneralizedExtremeValue(0,1,0)\ny = rand(pd, 300)\nfm = gevfit(y)\n\nreturnlevelplotci(fm)\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.mrlplot_data","page":"Functions","title":"Extremes.mrlplot_data","text":"mrlplot_data(y::Vector{<:Real}, steps::Int = 100)::DataFrame\n\nCompute the mean residual life from vector y.\n\nThe set of thresholds ranges from minimum(y) to the second-to-last larger value in steps number of steps.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.probplot_data","page":"Functions","title":"Extremes.probplot_data","text":"probplot_data(fm::fittedModel)\n\nReturn the probability plot data in a DataFrame.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.qqplot_data","page":"Functions","title":"Extremes.qqplot_data","text":"qqplot_data(fm::fittedModel)\n\nReturn the quantile-quantile plot data in a DataFrame.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.returnlevelplot_data","page":"Functions","title":"Extremes.returnlevelplot_data","text":"returnlevelplot_data(fm::fittedModel)\n\nReturn the return level plot data in a DataFrame.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Types","page":"Functions","title":"Types","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"Modules = [Extremes]\nPrivate = false\nOrder = [:type]","category":"page"},{"location":"functions/#Extremes.AbstractExtremeValueModel","page":"Functions","title":"Extremes.AbstractExtremeValueModel","text":"AbstractExtremeValueModel\n\nAbstract type containing the extreme value model types.\n\nBlockMaxima\nThresholdExceedance\n\n\n\n\n\n","category":"type"},{"location":"functions/#Extremes.AbstractFittedExtremeValueModel","page":"Functions","title":"Extremes.AbstractFittedExtremeValueModel","text":"AbstractFittedExtremeValueModel{T<:AbstractExtremeValueModel}\n\nAbstract type containing the fitted extreme value model types.\n\nBayesianAbstractExtremeValueModel\nMaximumLikelihoodAbstractExtremeValueModel\npwmAbstractExtremeValueModel\n\n\n\n\n\n","category":"type"},{"location":"functions/#Extremes.BlockMaxima-Union{Tuple{Variable}, Tuple{GeneralizedExtremeValue}} where GeneralizedExtremeValue","page":"Functions","title":"Extremes.BlockMaxima","text":"BlockMaxima{GeneralizedExtremeValue}(data::Vector{<:Real};\n    locationcov::Vector{Variable} = Vector{Variable}(),\n    logscalecov::Vector{Variable} = Vector{Variable}(),\n    shapecov::Vector{Variable} = Vector{Variable}())::BlockMaxima\n\nCreates a BlockMaxima structure.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.BlockMaxima-Union{Tuple{Variable}, Tuple{Gumbel}} where Gumbel","page":"Functions","title":"Extremes.BlockMaxima","text":"BlockMaxima{Gumbel}(data::Vector{<:Real};\n    locationcov::Vector{Variable} = Vector{Variable}(),\n    logscalecov::Vector{Variable} = Vector{Variable}())::BlockMaxima\n\nCreates a BlockMaxima{Gumbel} structure.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.Cluster","page":"Functions","title":"Extremes.Cluster","text":"Cluster(u₁::Real,u₂::Real,position::Vector{<:Int},value::Vector{<:Real})\n\nCluster type.\n\n\n\n\n\n","category":"type"},{"location":"functions/#Extremes.Flat","page":"Functions","title":"Extremes.Flat","text":"Flat()\n\nConstruct a Flat <: ContinuousUnivariateDistribution object representing an improper uniform distribution on the real line.\n\n\n\n\n\n","category":"type"},{"location":"functions/#Extremes.ReturnLevel","page":"Functions","title":"Extremes.ReturnLevel","text":"ReturnLevel\n\nReturnLevel type constructed by the function returnlevel.\n\n\n\n\n\n","category":"type"},{"location":"functions/#Extremes.ThresholdExceedance-Tuple{Variable}","page":"Functions","title":"Extremes.ThresholdExceedance","text":"ThresholdExceedance(exceedances::Vector{<:Real};\n    logscalecov::Vector{<:DataItem} = Vector{Variable}(),\n    shapecov::Vector{<:DataItem} = Vector{Variable}())::ThresholdExceedance\n\nCreates a ThresholdExceedance structure.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Extremes.Variable","page":"Functions","title":"Extremes.Variable","text":"Variable(name::String, value :: Vector{<:Real})\n\nConstruct a Variable type\n\n\n\n\n\n","category":"type"},{"location":"functions/#Extremes.VariableStd-Tuple{String, Vector{<:Real}}","page":"Functions","title":"Extremes.VariableStd","text":"VariableStd(name::String, z::Vector{<:Real})::VariableStd\n\nConstruct a VariableStd type from the standardized vector z with the name name.\n\n\n\n\n\n","category":"method"},{"location":"tutorial/blockmaxima_ns/#Non-Stationary-Block-Maxima-Model","page":"Non-stationary block maxima","title":"Non-Stationary Block Maxima Model","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"In the non-stationary block maxima model, the GEV parameters are allowed to be functions of multiple covariates:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"\\[ μ = X₁ × β₁ \\\\ ϕ = X₂ × β₂ \\\\  ξ = X₃ × β₃ \\]","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"where (X₁β₁), (X₂β₂) and (X₃β₃) are respectively the design matrix and the corresponding coefficient parameter vector of μ, ϕ and ξ.","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"note: Intercept\nAn intercept is included in all parameter functions by default.","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The non-stationary BlockMaxima model is illustrated using the annual maximum sea-levels recorded at Fremantle in West Australia from 1897 to 1989, studied by Coles (2001) in Chapter 6.","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"using Extremes, DataFrames, Distributions, Gadfly","category":"page"},{"location":"tutorial/blockmaxima_ns/#Load-the-data","page":"Non-stationary block maxima","title":"Load the data","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Loading the annual maximum sea-levels at Fremantle:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"data = Extremes.dataset(\"fremantle\")\nfirst(data,5)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The annual maxima can be plotted as function of the year:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"set_default_plot_size(12cm, 8cm) # hide\nplot(data, x=:Year, y=:SeaLevel, Geom.line,\n    Coord.cartesian(xmin=1895, xmax=1990), Guide.xticks(ticks=1895:10:1990))","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"and as function of the Southern Oscillation Index:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"set_default_plot_size(12cm, 8cm) # hide\nplot(data, x=:SOI, y=:SeaLevel, Geom.point)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Both variables can be included in the block maxima model. Parameter estimation can be performed either by maximum likelihood or by the Bayesian approach. Probability weighted moment estimation cannot be used in the non-stationary case.","category":"page"},{"location":"tutorial/blockmaxima_ns/#Maximum-likelihood-inference","page":"Non-stationary block maxima","title":"Maximum likelihood inference","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/#GEV-parameter-estimation","page":"Non-stationary block maxima","title":"GEV parameter estimation","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The GEV parameter estimation with maximum likelihood is performed with the gevfit function. The parameter estimate vector mathbfθ = (mathbfβ₁ mathbfβ₂ mathbfβ₃)^top is contained in the field θ̂ of the returned structure.","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Several non-stationary model can be fitted.","category":"page"},{"location":"tutorial/blockmaxima_ns/#The-stationary-model","page":"Non-stationary block maxima","title":"The stationary model","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"fm₀ = gevfit(data, :SeaLevel)","category":"page"},{"location":"tutorial/blockmaxima_ns/#The-location-parameter-varying-as-a-linear-function-of-the-year","page":"Non-stationary block maxima","title":"The location parameter varying as a linear function of the year","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"fm₁ = gevfit(data, :SeaLevel, locationcovid = [:Year])","category":"page"},{"location":"tutorial/blockmaxima_ns/#The-location-parameter-varying-as-a-linear-function-of-the-year-and-the-SOI","page":"Non-stationary block maxima","title":"The location parameter varying as a linear function of the year and the SOI","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"fm₂ = gevfit(data, :SeaLevel, locationcovid = [:Year, :SOI])","category":"page"},{"location":"tutorial/blockmaxima_ns/#Both-the-location-and-logscale-parameters-varying-as-a-linear-function-of-the-year-and-the-SOI","page":"Non-stationary block maxima","title":"Both the location and logscale parameters varying as a linear function of the year and the SOI","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"fm₃ = gevfit(data, :SeaLevel, locationcovid = [:Year, :SOI], logscalecovid = [:Year, :SOI])","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"As show by Coles (2001), the best model is the one where the location parameter varies as a linear function of the year and the SOI, the fm₂ in the present section. ","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The vector of the parameter estimates (location scale and shape) can be extracted with the function params:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"params(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The location parameter with the function location:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"location(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The scale parameter with the function Extremes.scale:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"scale(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The shape parameter with the function shape:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"shape(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The approximate covariance matrix of the parameter estimates for this model can be obtained with the parametervar function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"parametervar(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Confidence intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"cint(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"In particular, the 95% confidence interval for the rise in annual maximum sea-levels per year is as follows:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"cint(fm₂)[2]","category":"page"},{"location":"tutorial/blockmaxima_ns/#Diagnostic-plots","page":"Non-stationary block maxima","title":"Diagnostic plots","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Several diagnostic plots for assessing the accuracy of the GEV model fitted to the Fremantle data can be shown with the diagnosticplots function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The diagnostic plots consist in the residual probability plot (upper left panel), the residual quantile plot (upper right panel) and the residual density plot (lower left panel) of the standardized data (see Chapter 6 of Coles, 2001). These plots can be displayed separately using respectively the probplot, qqplot, histplot and returnlevelplot functions.","category":"page"},{"location":"tutorial/blockmaxima_ns/#Return-level-estimation","page":"Non-stationary block maxima","title":"Return level estimation","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Since the model parameters vary in time, the quantiles also vary in time. Therefore, a T-year return level can be estimated for each year. This set of return levels are referred to as effective return levels as proposed by Katz et al. (2002).","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The 100-year effective return levels for the fm₂ model can be computed using the returnlevel function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"r = returnlevel(fm₂, 100)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The effective return levels can be accessed as follows:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"r.value","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The corresponding confidence interval can be computed with the cint function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"c = cint(r)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The effective return levels along with their confidence intervals can be plotted as follows:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"rmin = [c[i][1] for i in eachindex(c)]\nrmax = [c[i][2] for i in eachindex(c)]\ndf = DataFrame(Year = data[:,:Year], r = r.value, rmin = rmin, rmax = rmax)\nnothing # hide","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"set_default_plot_size(12cm, 9cm)\nplot(df, x=:Year, y=:r, ymin=:rmin, ymax=rmax, Geom.line, Geom.ribbon,\n    Coord.cartesian(xmin=1895, xmax=1990), Guide.xticks(ticks=1895:10:1990),\n    Guide.ylabel(\"100-year Effective Return Level\"))\n","category":"page"},{"location":"tutorial/blockmaxima_ns/#Bayesian-Inference","page":"Non-stationary block maxima","title":"Bayesian Inference","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Most functions described in the previous sections also work in the Bayesian context. To reproduce exactly the results, the seed should be fixed as follows:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"import Random\nRandom.seed!(4786)\nnothing #hide","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Most functions described in the previous sections also work in the Bayesian context.","category":"page"},{"location":"tutorial/blockmaxima_ns/#GEV-parameter-estimation-2","page":"Non-stationary block maxima","title":"GEV parameter estimation","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The Bayesian GEV parameter estimation is performed with the gevfitbayes function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"fm = gevfitbayes(data, :SeaLevel, locationcovid = [:Year, :SOI])","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"note: Prior\nCurrently, only the improper uniform prior is implemented, i.e. \\[ f_{(β₁,β₂,β₃)}(β₁,β₂,β₃) ∝ 1. \\]","category":"page"},{"location":"tutorial/blockmaxima_ns/#Inference-for-the-non-stationary-Gumbel-distribution","page":"Non-stationary block maxima","title":"Inference for the non-stationary Gumbel distribution","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The package aslo provides functions for the inference of the non-stationary Gumbel model. Documentation on the Gumbel model can be found here in the Block Maxima section.","category":"page"},{"location":"tutorial/blockmaxima_ns/#Example-on-the-annual-maximum-sea-levels-recorded-at-Fremantle","page":"Non-stationary block maxima","title":"Example on the annual maximum sea-levels recorded at Fremantle","text":"","category":"section"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The location parameter varying as a linear function of the year and the SOI","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"fm₂ = gumbelfit(data, :SeaLevel, locationcovid = [:Year, :SOI])","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"Confidence intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"cint(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The diagnostic plots for assessing the accuracy of the Gumbel model fitted to the Fremantle data can be shown with the diagnosticplots function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm₂)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The 100-year effective return levels for the fm₂ model can be computed using the returnlevel function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"r = returnlevel(fm₂, 100)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The effective return levels can be accessed as follows:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"r.value","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The corresponding confidence interval can be computed with the cint function:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"c = cint(r)","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"The effective return levels along with their confidence intervals can be plotted as follows:","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"rmin = [c[i][1] for i in eachindex(c)]\nrmax = [c[i][2] for i in eachindex(c)]\ndf = DataFrame(Year = data[:,:Year], r = r.value, rmin = rmin, rmax = rmax)\nnothing # hide","category":"page"},{"location":"tutorial/blockmaxima_ns/","page":"Non-stationary block maxima","title":"Non-stationary block maxima","text":"set_default_plot_size(12cm, 9cm)\nplot(df, x=:Year, y=:r, ymin=:rmin, ymax=rmax, Geom.line, Geom.ribbon,\n    Coord.cartesian(xmin=1895, xmax=1990), Guide.xticks(ticks=1895:10:1990),\n    Guide.ylabel(\"100-year Effective Return Level\"))\n","category":"page"},{"location":"tutorial/additional/#Additional-features","page":"Additional features","title":"Additional features","text":"","category":"section"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"using Extremes, DataFrames, Distributions, Gadfly, Optim","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"Additional features on fitted model by maximum likelihood that were not included in Coles are also provided. They are presented here for the Port Pirie example.","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"Loading the annual maximum sea-levels at Port Pirie:","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"data = Extremes.dataset(\"portpirie\")\nfirst(data,5)","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"Fitting the GEV parameters by maximum likelihood:","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"fm = gevfit(data, :SeaLevel)","category":"page"},{"location":"tutorial/additional/#Akaike-information-criterion-(AIC)","page":"Additional features","title":"Akaike information criterion (AIC)","text":"","category":"section"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"The AIC of the fitted model can be obtained with the function aic","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"aic(fm)","category":"page"},{"location":"tutorial/additional/#Bayesian-information-criterion-(BIC)","page":"Additional features","title":"Bayesian information criterion (BIC)","text":"","category":"section"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"The BIC of the fitted model can be obtained with the function bic","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"bic(fm)","category":"page"},{"location":"tutorial/additional/#Profile-likelihood","page":"Additional features","title":"Profile likelihood","text":"","category":"section"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"\ndf = DataFrame( ξ = Float64[], pl = Float64[])\n\n# Computing the profile loglikelihood for different values of ξ\n\nfor ξ in -.3:.01:.3\n\n    fobj(θ::DenseVector) = -Extremes.loglike(fm.model, [θ[1], θ[2], ξ])\n\n    res = optimize(fobj, [3., 0.])\n    \n    push!(df, [ξ, -Optim.minimum(res)])\n    \nend\n\nset_default_plot_size(12cm, 8cm)\n\nplot(df, x=:ξ, y=:pl, Geom.line, Guide.ylabel(\"Profile log likelihood\"))","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"\n# 95% quantile of the Chi squared distribution with one degree of freedom\nc = quantile(Chisq(1), .95)\n\n# Maximum and maximum position of the profile log likelihood\nfm = findmax(df.pl)\n\n# High for the confidence interval\nh = fm[1]-.5*c\n\n# left bound\nl = argmin(abs.(h.-df.pl[1:fm[2]]))\n\n# right bound\nr = fm[2] -1 + argmin(abs.(h.-df.pl[fm[2]:end]))\n\nplot(df, x=:ξ, y=:pl, Geom.line,\n    xintercept=[df.ξ[l], df.ξ[r]], Geom.vline(color=\"red\", style=:dash),\n    yintercept = [fm[1], h], Geom.hline(color=\"red\", style=:dash),\n    Guide.ylabel(\"Profile log likelihood\"))","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"The corresponding 95% confidence interval for ξ based on the profile log likelihood is the following:","category":"page"},{"location":"tutorial/additional/","page":"Additional features","title":"Additional features","text":"println(\"[\", df.ξ[l],\" , \" , df.ξ[r] , \"]\")","category":"page"},{"location":"tutorial/ThresholdExceedance/#Threshold-Exceedance-Model","page":"Threshold exceedance","title":"Threshold Exceedance Model","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The stationary ThresholdExceedance model is illustrated using the daily rainfall accumulations at a location in south-west England from 1914 to 1962. This dataset was studied by Coles (2001) in Chapter 4. The daily rainfall are assume  independent and identically distributed.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"using Extremes, Dates, DataFrames, Distributions, Gadfly","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The Extremes.jl package supports maximum likelihood inference, Bayesian inference and inference based on the probability weigthed moments. For the GEV parameter estimation, the following functions can be used:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"gpfitpwm: estimation with the probability weighted moments;\ngpfit: maximum likelihood estimation;\ngpfitbayes: Bayesian estimation.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"note: Log-scale paremeter\nThese functions return the estimate of the log-scale parameter phi = log sigma.","category":"page"},{"location":"tutorial/ThresholdExceedance/#Load-the-data","page":"Threshold exceedance","title":"Load the data","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Loading the daily precipitations:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"data = Extremes.dataset(\"rain\")\nfirst(data,5)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Plotting the data using the Gadfly package:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"set_default_plot_size(14cm ,8cm) # hide\nplot(data, x=:Date, y=:Rainfall, Geom.point, Theme(discrete_highlight_color=c->nothing))","category":"page"},{"location":"tutorial/ThresholdExceedance/#Threshold-selection","page":"Threshold exceedance","title":"Threshold selection","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"A suitable threshold for the Peaks-Over-Threshold model can be chosen by examining the mean residual life plot. The mean residual life is expected to be a linear function of the threshold when the latter is high enough. The mean residual life plot can be plotted with the mrlplot function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"set_default_plot_size(14cm ,8cm) # hide\nmrlplot(data[:,:Rainfall])","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"As concluded by Coles (2001, Chapter 4), a reasonable threshold is 30 mm.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"threshold = 30.0\nnothing # hide","category":"page"},{"location":"tutorial/ThresholdExceedance/#Exceedances-extraction","page":"Threshold exceedance","title":"Exceedances extraction","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Parameter estimation of the Generalized Pareto distribution in Extremes.jl is performed using the threshold exceedances previously extracted. The support of the exceedances given in the fit function is therefore (0).","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"For the Rainfall example, let's extract the threshold exceedances.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Identify first the threshold exceedances:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"threshold = 30.0\ndf = filter(row -> row.Rainfall > threshold, data)\nfirst(df, 5)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Retrieve the exceedances above the threshold:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"df[!,:Rainfall] =  df[!,:Rainfall] .- threshold\nrename!(df, :Rainfall => :Exceedance)\nfirst(df, 5)","category":"page"},{"location":"tutorial/ThresholdExceedance/#Maximum-likelihood-inference","page":"Threshold exceedance","title":"Maximum likelihood inference","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/#GP-parameter-estimation","page":"Threshold exceedance","title":"GP parameter estimation","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The Generalized Pareto maximum likelihood parameter estimates are computed with the gpfit function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"fm = gpfit(df, :Exceedance)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"note: Note\nIn this example, the gpfit function is called using the data DataFrame structure as the first argument. The function can also be called using the vector of maxima as the first argument, e.g. gpfit(df[:,:Exceedance]).","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The parameter estimates (location, scale and shape) can be extracted with the function params:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"params(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The scale parameter estimate can be obtained with Extremes.scale:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"scale(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"and the shape parameter estimate with shape:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"shape(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"note: Type-stable function\nThese functions return a unit dimension vector for the return level and a vector containing only one vector for the confidence interval. The reason is that the functions always return the same type in the stationary and non-stationary case. The functiona are therefore type-stable allowing better performance of code execution.  ","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The approximate covariance matrix of the parameter estimates can be obtained with the  parametervar function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"parametervar(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Confidence intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"cint(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"For instance, the shape parameter 95% confidence interval is as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"cint(fm)[2]","category":"page"},{"location":"tutorial/ThresholdExceedance/#Diagnostic-plots","page":"Threshold exceedance","title":"Diagnostic plots","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Several diagnostic plots for assessing the accuracy of the fitted GP distribution to the rainfall data are can be shown with the diagnosticplots function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The diagnostic plots consist in the probability plot (upper left panel), the quantile plot (upper right panel), the density plot (lower left panel) and the return level plot (lower right panel). These plots can be displayed separately using respectively the probplot, qqplot, histplot and returnlevelplot functions.","category":"page"},{"location":"tutorial/ThresholdExceedance/#Return-level-estimation","page":"Threshold exceedance","title":"Return level estimation","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"T-year return level estimate can be obtained using the returnlevel function. Along with the fitted Generalized Pareto distribution for the threshold exceedances, the following informations:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"the threshold;\nthe number of total observation;\nthe number of observation per year.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"are also needed for estimating the T-year return level using the POT model.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"For example, the 100-year return level for the rainfall POT model is computed as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"nobs = size(data,1)\nnobsperblock = 365\nr = returnlevel(fm, threshold, nobs, nobsperblock, 100)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The return level can be accessed as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"r.value","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The corresponding confidence interval can be computed with the cint function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"c = cint(r)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"To get the scalar return level in the stationary case, the following command can be used:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"r.value[]","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"To get the scalar confidence interval in the stationary case, the following command can be used:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"c[]","category":"page"},{"location":"tutorial/ThresholdExceedance/#Bayesian-Inference","page":"Threshold exceedance","title":"Bayesian Inference","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Most functions described in the previous sections also work in the Bayesian context. To reproduce exactly the results, the seed should be fixed as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"import Random\nRandom.seed!(4786)\nnothing #hide","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Most functions described in the previous sections also work in the Bayesian context.","category":"page"},{"location":"tutorial/ThresholdExceedance/#GP-parameter-estimation-2","page":"Threshold exceedance","title":"GP parameter estimation","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The Bayesian GP parameter estimation is performed with the gpfitbayes function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"fm = gpfitbayes(df, :Exceedance)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"note: Prior\nCurrently, only the improper uniform prior is implemented, i.e. \\[ f_{(ϕ,ξ)}(ϕ,ξ) ∝ 1. \\] It yields to a proper posterior as long as the sample size is larger than 2 (Northrop and Attalides, 2016).","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"note: Sampling scheme\nCurrently, the No-U-Turn Sampler extension (Hoffman and Gelman, 2014) to Hamiltonian Monte Carlo (Neel, 2011, Chapter 5) is implemented for simulating an autocorrelated sample from the posterior distribution.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The generated sample from the posterior distribution is contained in the field sim of the fitted structure. It is an object of type Chains from the Mamba.jl package.","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The MCMC sample of the scale and shape parameters can be extracted respectively with the functions Extremes.scale and shape. The marginal chains for those parameters can be plotted as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"set_default_plot_size(12cm ,10cm) #hide\np1 = plot(y = Extremes.scale(fm), Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"σ\"))\n\np2 = plot(y = Extremes.shape(fm), Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"ξ\"))\n\nvstack(p1, p2)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Several diagnostic plots for assessing the accuracy of the fitted GP distribution to the rainfall data are can be shown with the diagnosticplots function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Credible intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"cint(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The empirical covariance matrix of the parameters can be obtained with parametervar as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"parametervar(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The T-year return level estimate can be obtained using the function returnlevel. Along with  the fitted generalized Pareto distribution for the threshold exceedances, the following information is  also needed for estimating the T-year return level using the POT model: the threshold, the number of  total observations and the number of observations per year. For example, the 100-year return level  for the rainfall POT model is computed as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"nobs = size(data,1)\nnobsperblock = 365\nr = returnlevel(fm, threshold, nobs, nobsperblock, 100)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"A punctual estimate can be obtained by taking the mean of the return level sample as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"mean(r.value)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"A credidle interval of level 95% can be obtained with the function cint as follows:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"cint(r, .95)","category":"page"},{"location":"tutorial/ThresholdExceedance/#Inference-based-on-the-probability-weighted-moments","page":"Threshold exceedance","title":"Inference based on the probability weighted moments","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Most functions described in the previous sections also work for the model fitted with the probability weighted moments.","category":"page"},{"location":"tutorial/ThresholdExceedance/#GP-parameter-estimation-3","page":"Threshold exceedance","title":"GP parameter estimation","text":"","category":"section"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The parameter estimation based on the probability weighted moments is performed with the gpfitpwm function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"fm = gpfitpwm(df, :Exceedance)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"The approximate covariance matrix of the parameter estimates using a bootstrap procedure can be obtained with the parametervar function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"parametervar(fm)","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"Confidence intervals on the parameter estimates using a bootstrap procedure can be obtained with the cint function:","category":"page"},{"location":"tutorial/ThresholdExceedance/","page":"Threshold exceedance","title":"Threshold exceedance","text":"cint(fm)","category":"page"},{"location":"contributing/#Contributing","page":"Contributing","title":"Contributing","text":"","category":"section"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"Contributions are welcomed. Here's the workflow for development of new features, refactoring and bugfix.","category":"page"},{"location":"contributing/","page":"Contributing","title":"Contributing","text":"master             # Stable branch, always ready to be tagged\ndev                # Development branch. New features, refactoring, bug and hotfix\n                   # are integrated into dev before going into master.\nfeature/           # New feature needs a `feature` prefix\n   <feature-name>     \nrefactor/          # Refactoring are tagged with a `refactor` prefix\n   <refactor-name>\nbug/               # Prefix for bugs found during development\n   <bug-fix>       \nhotfix/            # Prefix for hotfix (bugs for deployed versions)\n   <hot-fix>    ","category":"page"},{"location":"tutorial/BlockMaxima/#Block-Maxima-Model","page":"Block maxima","title":"Block Maxima Model","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The stationary BlockMaxima model is illustrated using the annual maximum sea-levels recorded at Port Pirie in South Australia from 1923 to 1987, studied by Coles (2001) in Chapter 3. The annual maxima are assumed independent and identically distributed.","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"using Extremes, DataFrames, Distributions, Gadfly","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The Extremes.jl package supports maximum likelihood inference, Bayesian inference and inference based on the probability weigthed moments. For the GEV parameter estimation, the following functions can be used:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"gevfitpwm: estimation with the probability weighted moments;\ngevfit: maximum likelihood estimation;\ngevfitbayes: Bayesian estimation.","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"note: Log-scale paremeter\nThese functions shows the estimate of the log-scale parameter phi = log sigma instead of the scale parameter.","category":"page"},{"location":"tutorial/BlockMaxima/#Load-the-data","page":"Block maxima","title":"Load the data","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Loading the annual maximum sea-levels at Port Pirie:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"data = Extremes.dataset(\"portpirie\")\nfirst(data,5)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The annual maxima can be shown as a function of the year using the Gadfly package:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"set_default_plot_size(12cm, 8cm)\nplot(data, x=:Year, y=:SeaLevel, Geom.line)","category":"page"},{"location":"tutorial/BlockMaxima/#Maximum-likelihood-inference","page":"Block maxima","title":"Maximum likelihood inference","text":"","category":"section"},{"location":"tutorial/BlockMaxima/#GEV-parameter-estimation","page":"Block maxima","title":"GEV parameter estimation","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The GEV parameter estimation with maximum likelihood is performed with the gevfit function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"fm = gevfit(data, :SeaLevel)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"note: Note\nIn this example, the gevfit function is called using the data DataFrame structure as the first argument. The function can also be called using the vector of maxima as the first argument, e.g. gevfit(data[:,:SeaLevel]).","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The vector of the parameter estimates (location scale and shape) can be extracted with the function params:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"params(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The location parameter with the function location:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"location(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The scale parameter with the function Extremes.scale:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"scale(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The shape parameter with the function shape:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"shape(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"note: Type-stable function\nThese functions return a unit dimension vector for the return level and a vector containing only one vector for the confidence interval. The reason is that the functions always return the same type in the stationary and non-stationary case. The functions are therefore type-stable allowing better performance of code execution.  ","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The approximate covariance matrix of the parameter estimates can be obtained with the  parametervar function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"parametervar(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Confidence intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"cint(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"For instance, the shape parameter 95% confidence interval is as follows:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"cint(fm)[3]","category":"page"},{"location":"tutorial/BlockMaxima/#Diagnostic-plots","page":"Block maxima","title":"Diagnostic plots","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Several diagnostic plots for assessing the accuracy of the GEV model fitted to the Port Pirie data are can be shown with the diagnosticplots function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The diagnostic plots consist in the probability plot (upper left panel), the quantile plot (upper right panel), the density plot (lower left panel) and the return level plot (lower right panel). These plots can be displayed separately using respectively the probplot, qqplot, histplot and returnlevelplot functions.","category":"page"},{"location":"tutorial/BlockMaxima/#Return-level-estimation","page":"Block maxima","title":"Return level estimation","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"T-year return level estimate can be obtained using the returnlevel function. For example, the 100-year return level for the Port Pirie block maxima model is computed as follows:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"r = returnlevel(fm, 100)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The return level can be accessed as follows:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"r.value","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The corresponding confidence interval can be computed with the cint function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"c = cint(r)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"To get the scalar return level in the stationary case, the following command can be used:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"r.value[]","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"To get the scalar confidence interval in the stationary case, the following command can be used:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"c[]","category":"page"},{"location":"tutorial/BlockMaxima/#Bayesian-Inference","page":"Block maxima","title":"Bayesian Inference","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Most functions described in the previous sections also work in the Bayesian context. To reproduce exactly the results, the seed should be fixed as follows:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"import Random\nRandom.seed!(4786)\nnothing #hide","category":"page"},{"location":"tutorial/BlockMaxima/#GEV-parameter-estimation-2","page":"Block maxima","title":"GEV parameter estimation","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The Bayesian GEV parameter estimation is performed with the gevfitbayes function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"fm = gevfitbayes(data, :SeaLevel)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"note: Prior\nCurrently, only the improper uniform prior is implemented, i.e. \\[ f_{(μ,ϕ,ξ)}(μ,ϕ,ξ) ∝ 1. \\] It yields to a proper posterior as long as the sample size is larger than 3 (Northrop and Attalides, 2016).","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"note: Sampling scheme\nCurrently, the No-U-Turn Sampler extension (Hoffman and Gelman, 2014) to Hamiltonian Monte Carlo (Neel, 2011, Chapter 5) is implemented for simulating an autocorrelated sample from the posterior distribution.","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The generated sample from the posterior distribution is contained in the field sim of the fitted structure. It is an object of type Chains from the Mamba.jl package.","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Credible intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"cint(fm)","category":"page"},{"location":"tutorial/BlockMaxima/#Inference-based-on-the-probability-weighted-moments","page":"Block maxima","title":"Inference based on the probability weighted moments","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Most functions described in the previous sections also work for the model fitted with the probability weighted moments.","category":"page"},{"location":"tutorial/BlockMaxima/#GEV-parameter-estimation-3","page":"Block maxima","title":"GEV parameter estimation","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The parameter estimation based on the probability weighted moments is performed with the gevfitpwm function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"fm = gevfitpwm(data, :SeaLevel)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The approximate covariance matrix of the parameter estimates using a bootstrap procedure can be obtained with the parametervar function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"parametervar(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Confidence intervals on the parameter estimates using a bootstrap procedure can be obtained with the cint function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"cint(fm)","category":"page"},{"location":"tutorial/BlockMaxima/#Inference-for-the-Gumbel-distribution","page":"Block maxima","title":"Inference for the Gumbel distribution","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The inference for the Gumbel distribution is also provided for modeling the series of block maxima. The Gumbel distribution is a sub-family of the GEV distribution when the shape parameter xi = 0. The library provides functions analogous to those for the GEV distribution for the adjustment of the parameters of the Gumbel distribution:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"by maximum likelihood gumbelfit;\nunder the Bayesian paradigm gumbelfitbayes;\nby the method of moments gumbelfitpwm.","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The inference for the fitted model is performed with the same methods defined previously for the GEV distribution, notably with the cint and returnlevel methods. Diagnostic plot methods diagnosticplots are also implemented, such as probplot, qqplot, histplot and returnlevelplot.","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"note: Gumbel distribution for modelling block maxima\nAs extreme-value statisticians, we advocate avoiding the use of the Gumbel distribution for modelling the block maxima. This is because the choice of family is made with the data at hand, and when extrapolating to large quantiles, i.e. larger than the range of the data, the uncertainty associated with this choice is not taken into account. If the data suggest that the Gumbel family is the best one, this does not imply that the other families are not plausible. In applications, the confidence intervals on the shape parameter are often wide, representing the difficulty of discriminating the tail behavior using only the limited number of data. Therefore, we plead for the use of the GEV distribution for the block maxima model without choosing a subfamily such as the Gumbel. As Coles (2001) also argued in Page 64, this is \"... the safest option is to accept there is uncertainty about the value of the shape parameter ... and to prefer the inference based on the GEV model. The larger measures of uncertainty generated by the GEV model then provide a more realistic quantification of the genuine uncertainties involved in model extrapolation\".","category":"page"},{"location":"tutorial/BlockMaxima/#Example-on-the-annual-maximum-sea-levels-recorded-at-Port-Pirie","page":"Block maxima","title":"Example on the annual maximum sea-levels recorded at Port Pirie","text":"","category":"section"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The Gumbel distribution parameter estimation with maximum likelihood can be performed with the gumbelfit function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"fm = gumbelfit(data, :SeaLevel)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The approximate covariance matrix of the parameter estimates can be obtained with the  parametervar function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"parametervar(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"Confidence intervals for the parameters are obtained with the cint function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"cint(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The diagnostic plots for assessing the accuracy of the Gumbel model can be shown with the diagnosticplots function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The 100-year return level for the Port Pirie block maxima model is computed with the returnlevel function  as follows:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"r = returnlevel(fm, 100)","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The return level can be accessed as follows:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"r.value","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"The corresponding confidence interval can be computed with the cint function:","category":"page"},{"location":"tutorial/BlockMaxima/","page":"Block maxima","title":"Block maxima","text":"c = cint(r)","category":"page"},{"location":"tutorial/Declustering/#Declustering-threshold-exceedances","page":"Declustering","title":"Declustering threshold exceedances","text":"","category":"section"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"When the data are dependent, the exceedances may have a tendency to cluster. It is common to assume that the marginal distribution of each exceedance is the Generalized Pareto (see for example Chapter 5 of Coles , 2001). Various methods have been proposed for dealing with the problem of dependent exceedances. The most widely-adopted one consists in declustering the exceedances, which corresponds to a filtering of the exceedances to obtain a set of that are approximately independent. As summarized by Coles (2001), the declustering approach consists in:","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"identifying cluster of extreme values;\nretrieving the cluster maxima;\nassuming that each cluster maxima are independent;\nfitting the GP distribution to the cluster maxima.","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"In Extremes.jl, two methods for identifying cluster of extreme values are implemented in the getcluster function: the runs method and the two thresholds method. The function returns a vector of Cluster type.","category":"page"},{"location":"tutorial/Declustering/#Data-loading","page":"Declustering","title":"Data loading","text":"","category":"section"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"Both methods for identifying the clusters are illustrated with the Wooster dataset studied by Coles (2001). This dataset consists in the daily temperature minimum recorded in Wooster, Ohio, from 1983 to 1988. The attention is restricted to the winter months (November to February) and to the negated series for using the model defined for maxima.","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"using Extremes, Dates, DataFrames, Distributions, Gadfly","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"data = Extremes.dataset(\"wooster\")\nset_default_plot_size(12cm, 8cm) # hide\nplot(data, x=:Date, y=:Temperature, Geom.point)","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"df = copy(data)\ndf[!,:Temperature] = -data[:,:Temperature]\nfilter!(row -> month(row.Date) ∈ (1,2,11,12), df)\nplot(df, x=:Date, y=:Temperature, Geom.point)","category":"page"},{"location":"tutorial/Declustering/#The-runs-method","page":"Declustering","title":"The runs method","text":"","category":"section"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"Two cluster definitions are used in Extremes.jl. The first one is based on the runs method: exceedances separated by fewer than r non-exceedances are assumed to belong to the same cluster (see Chapter 10 of Beirlant et al., 2004). The parameter r is generally referred to as the runlength parameter. When r = 0, each exceedance forms a separate cluster.","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"When using the threshold of -10°F and the runlength of 4, 17 clusters are idenfied:","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"threshold =  -10.0\ncluster = getcluster(df[:,:Temperature], threshold, runlength=4)\nnothing # hide","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"The first cluster can be retrieved as follows:","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"first(cluster)","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"The GP distribution can be fitted on the cluster maximal exceedances (the cluster maximum can be computed with the maximum method applied to the Cluster type):","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"z = maximum.(cluster)","category":"page"},{"location":"tutorial/Declustering/#The-two-thresholds-method","page":"Declustering","title":"The two thresholds method","text":"","category":"section"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"With the two thresholds method, a cluster of threshold exceedances is defined as a streak of data higher than a second threshold u₂ whose at least one data is higher than a first threshold u₁, where u₁  u₂.","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"When using the u₁ = 0F as the first threshold and u₂ = -10F as the second threshold, 11 clusters are idenfied:","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"u₁ = -10\nu₂ = -15\ncluster = getcluster(df[:,:Temperature], u₁, u₂)\nnothing # hide","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"The first cluster can be retrieved as follows:","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"first(cluster)","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"The GP distribution can be fitted on the cluster maximal exceedances:","category":"page"},{"location":"tutorial/Declustering/","page":"Declustering","title":"Declustering","text":"z = maximum.(cluster)","category":"page"},{"location":"tutorial/#Tutorial","page":"Getting started","title":"Tutorial","text":"","category":"section"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"This tutorial shows the functionalities of Extremes.jl. They are illustrated by reproducing some of the results shown by Coles (2001) in An Introduction to Statistical Modeling of Extreme  Values.","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"Before executing this tutorial, make sure to have installed the following packages:","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"Extremes.jl (of course)\nDataFrames.jl (for using the DataFrame type)\nDistributions.jl (for using probability distribution objects)\nGadfly.jl (for plotting)","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"and import them using the following command:","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"using Extremes, Dates, DataFrames, Distributions, Gadfly","category":"page"},{"location":"#Extreme-value-analysis-in-Julia","page":"Extreme value analysis in Julia","title":"Extreme value analysis in Julia","text":"","category":"section"},{"location":"","page":"Extreme value analysis in Julia","title":"Extreme value analysis in Julia","text":"Extremes.jl provides exhaustive high-performance functions for the analysis of extreme values in Julia. In particular, methods for block maxima and threshold exceedances models are implemented, such as:","category":"page"},{"location":"","page":"Extreme value analysis in Julia","title":"Extreme value analysis in Julia","text":"Parameter estimation by probability weighted moments, maximum likelihood and Bayesian procedure.\nStationary and non-stationary models.\nDiagnostic plots for assessing model accuracy.\nReturn level estimation.","category":"page"},{"location":"","page":"Extreme value analysis in Julia","title":"Extreme value analysis in Julia","text":"The package is largely based on the books of Coles (2001), An Introduction to Statistical Modeling of Extreme Values, and of Beirlant et al. (2004) Statistics of Extremes: Theory and Applications. The Tutorial section illustrates the package functionalities by reproducing many results obtained by Coles (2001).","category":"page"}]
}
